<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Комитет информационных технологий</title>


    <link type="text/css" rel="stylesheet" href="/css/bootstrap.min.css">
    <!-- Compiled and minified CSS -->


    <!-- Compiled and minified JavaScript -->
    <script src="/libs/popper.min.js"></script>
    <script src="/libs/jquery-3.4.1.min.js"></script>
    <script src="/libs/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<body>
<div th:insert="~{navbar-bootstrap::frag ('Импорт Excel')}"></div>

<div th:if="${errorMessage != null}">
    <div  class="alert alert-primary" role="alert">
        <span th:text="${errorMessage}"></span>
    </div>
</div>





<div class="container" onload="checkFields()">
    <form name="upload" enctype="multipart/form-data" action="/upload" method="POST">
        <ul class="list-group">
            <li class="list-group-item"><a href="/" download>Скачайте шаблон excel</a></li>
            <li class="list-group-item"><span>Заполните его</span></li>
            <li class="list-group-item">
                <div><span>Прикрепите заполненный шаблон: </span>
                    <input hidden="true" id="fileInput" type="file" name="excelFile" onchange="getName(this.value, 'excel-button-label'); checkFields();" accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">
                    <label for="fileInput" class="btn btn-primary">
                        <i class="material-icons">note_add</i>
                        <span id="excel-button-label">Загрузить файл</span>
                    </label>
                    <div id="excel-file-form-label"></div>
                </div>
            </li>
            <li class="list-group-item">
                <div><span>Загрузить PDF-файл с пояснением обоснования: </span>
                    <input hidden="true" id="pdfFile" type="file" name="pdfFile" onchange="getName(this.value, 'pdf-button-label'); checkFields();" accept="application/pdf">
                    <label for="pdfFile" class="btn btn-primary">
                        <i class="material-icons">picture_as_pdf</i>
                        <span id="pdf-button-label">Загрузить файл</span>
                    </label>
                </div>
            </li>
            <li class="list-group-item">
                <textarea style="width: 100%" rows="7">
                Управление Роспотребнадзора по Республике Бурятия рекомендует работодателям, которые возобновили свою деятельность, обеспечить реализацию мероприятий, направленных на профилактику распространения COVID-19:
                - привлекать к работе минимально количество сотрудников;
                -  при входе работников в организацию (предприятие) - возможность обработки рук кожными антисептиками, предназначенными для этих целей
                (в том числе с помощью установленных дозаторов), или дезинфицирующими салфетками с установлением контроля за соблюдением этой гигиенической процедуры;
                -   контроль температуры тела работников при входе работников в организацию (предприятие), и в течение рабочего дня (по показаниям), с применением аппаратов для измерения температуры тела бесконтактным или контактным способом (электронные, инфракрасные термометры, переносные тепловизоры) с обязательным отстранением от нахождения на рабочем месте лиц с повышенной температурой тела и с признаками инфекционного заболевания;
                - контроль соблюдения самоизоляции работников на дому на установленный срок (14 дней) при возвращении их из Москвы и стран, где зарегистрированы случаи новой коронавирусной инфекции (COVID-19);
                -  информирование работников о необходимости соблюдения правил личной и общественной гигиены: режима регулярного мытья рук с мылом или обработки кожными антисептиками - в течение всего рабочего дня;
                -  качественную уборку помещений с применением дезинфицирующих средств вирулицидного действия, уделив особое внимание дезинфекции дверных ручек, выключателей, поручней, перил, контактных поверхностей (столов и стульев работников, орг.техники), мест общего пользования (комнаты приема пищи, отдыха, туалетных комнат, комнаты и оборудования для занятия спортом и т.п.), во всех помещениях - с кратностью обработки каждые 2 часа;
                -  наличие в организации не менее чем пятидневного запаса дезинфицирующих средств для уборки помещений и обработки рук сотрудников, средств индивидуальной защиты органов дыхания на случай выявления лиц с признаками инфекционного заболевания (маски, респираторы);
                - регулярное (каждые 2 часа) проветривание рабочих помещений;
                - применение в рабочих помещениях бактерицидных ламп, рециркуляторов воздуха закрытого типа с целью регулярного обеззараживания воздуха (по возможности).


                Правила дезинфекционных мероприятий.
                С целью профилактики и борьбы с инфекциями, вызванными коронавирусами, проводят дезинфекцию. Для проведения дезинфекции применяют дезинфицирующие средства, зарегистрированные в установленном порядке. В Инструкциях по применению этих средств указаны режимы для обеззараживания объектов при вирусных инфекциях.
                Для дезинфекции могут быть использованы средства из различных химических групп: хлорактивные (натриевая соль дихлоризоциануровой кислоты – в концентрации активного хлора в рабочем растворе не менее 0,06%, хлорамин Б – в концентрации активного хлора в рабочем растворе не менее 3,0%), кислородактивные (перекись водорода – в концентрации не менее 3,0%), катионные поверхностно-активные вещества (КПАВ) – четвертичные аммониевые соединения (в концентрации в рабочем растворе не менее 0,5%), третичные амины (в концентрации в рабочем растворе не менее 0,05%), полимерные производные гуанидина (в концентрации в рабочем растворе не менее 0,2%), спирты (в качестве кожных антисептиков и дезинфицирующих средств для обработки небольших по площади поверхностей – изопропиловый спирт в концентрации не менее 70% по массе, этиловый спирт в концентрации не менее 75% по массе).  Для проведения дезинфекции поверхностей также возможно использовать гипохлорит кальция (натрия) в концентрации не менее 0,5% по активному хлору и средства на основе дихлорантина - 0,05% по активному хлору; кроме того, для поверхностей небольшой площади может использоваться этиловый спирт 70%. Содержание действующих веществ указано в Инструкциях по применению.
                Обеззараживанию подлежат все поверхности в помещениях, включая руки, предметы обстановки, подоконники, спинки кроватей, прикроватные тумбочки, дверные ручки, посуда, игрушки, воздух и другие объекты.
                Для текущей дезинфекции следует применять дезинфицирующие средства, разрешенные к использованию в присутствии людей (на основе катионных поверхностно-активных веществ) способом протирания. Столовую посуду и прочие предметы обрабатывают способом погружения в растворы дезинфицирующих средств.
                Все виды работ с дезинфицирующими средствами следует выполнять во влагонепроницаемых перчатках одноразовых или многократного применения (при медицинских манипуляциях). При проведении заключительной дезинфекции способом орошения используют средства индивидуальной защиты (СИЗ). Органы дыхания защищают респиратором, глаз –защитными очками или используют противоаэрозольные СИЗ органов дыхания с изолирующей лицевой частью.
                Дезинфицирующие средства хранят в упаковках изготовителя, плотно закрытыми в специально отведенном сухом, прохладном и затемненном месте, недоступном для детей.
                Для гигиенической обработки рук могут использоваться кожные антисептики с содержанием спирта этилового (не менее 70% по массе), спирта изопропилового (не менее 60% по массе) или смеси спиртов (не менее 60% по массе), а также парфюмерно-косметическая продукция (жидкости, лосьоны, гели, одноразовые влажные салфетки) с аналогичным содержанием спиртов.

                В зависимости от условий питания работников рекомендовать:
                При наличии столовой для питания работников:
                -        обеспечить использование посуды однократного применения с последующим ее сбором, обеззараживанием и уничтожением в установленном порядке;
                -        при использовании посуды многократного применения - ее обработку желательно проводить на специализированных моечных машинах в соответствии с инструкцией по ее эксплуатации с применением режимов обработки, обеспечивающих дезинфекцию посуды и столовых приборов при температуре не ниже 65 град.С в течение 90 минут или ручным способом при той же температуре с применением дезинфицирующих средств в соответствии с требованиями санитарного законодательства.
                При отсутствии столовой:
                -        запретить прием пищи на рабочих местах, пищу принимать только в специально отведенной комнате – комнате приема пищи;
                -        при отсутствии комнаты приема пищи, предусмотреть выделение помещения для этих целей с раковиной для мытья рук (подводкой горячей и холодной воды), обеспечив его ежедневную уборку с помощью дезинфицирующих средств.
                При поступлении запроса из Управления Федеральной службы по надзору в сфере защиты прав потребителей и благополучия человека по РБ незамедлительно представлять информацию о всех контактах заболевшего новой коронавирусной инфекцией (COVID-19) в связи с исполнением им трудовых функций, обеспечить проведение дезинфекции помещений, где находился заболевший.
                Меры предосторожности.
                Гражданам необходимо соблюдать меры личной гигиены – использовать защитные маски, регулярно мыть руки с мылом и обрабатывать антисептиками, избегать близких контактов и пребывания в одном помещении с людьми, имеющими видимые признаки ОРВИ (кашель, чихание, выделения из носа), ограничить при приветствии тесные объятия и рукопожатия, соблюдать дистанцию не менее 1,5 м., пользоваться только индивидуальными предметами личной гигиены.
                            </textarea>
            </li>
            <li class="list-group-item">
                <span>
                    Подтверждаю обязательное выполнение требований по защите от COVID-19
                    <span class="text-danger">*</span>
                    : <input id="protect-checkbox" type="checkbox" name="isProtected" aria-label="Checkbox for following text input" onchange="changeComboBox(this); checkFields();">
                </span>
            </li>
            <li class="list-group-item">

                <textarea style="width: 100%" rows="7">
                    СОГЛАСИЕ на обработку персональных данных (далее – «Согласие»)
                    Настоящим я, во исполнение требований Федерального закона от 27.07.2006 г. № 152-ФЗ «О персональных данных» (с изменениями и дополнениями) свободно, своей волей и в своем интересе даю свое согласие: Администрации Главы РБ и Правительства Республики Бурятия, юридический адрес: 670001, г. Улан-Удэ, ул. Ленина, д.54, ИНН 0323082280 (далее - Администрация), на обработку, с использованием средств автоматизации или без использования таких средств, персональных данных (фамилия, имя отчество сотрудников организации), включая сбор, запись, систематизацию, удаление и уничтожение персональных данных при подаче заявки с предоставлением сведений о численности работников организаций и индивидуальных предпринимателей.
                    Настоящим я уведомлен Администрацией о том, что предполагаемыми пользователями персональных данных сотрудников моей организации являются работники Администрации.
                    Я ознакомлен(а), что: настоящее согласие на обработку персональных данных моей организации являются бессрочным и может быть отозвано посредством направления в адрес Администрации письменного заявления.
                </textarea>
            </li>
            <li class="list-group-item">
                <span>
                    Подтверждаю согласие работников на обработку персональных данных
                    <span class="text-danger">*</span>
                    : <input id="agreed-checkbox" type="checkbox" name="isAgreed"  aria-label="Checkbox for following text input" onchange="changeComboBox(this); checkFields();"></span>

            </li>
        </ul>
        <li class="list-group-item" style="align-items: center; justify-content: center">
            <div style="width:100%" class="mx-auto">
                <input type="submit" id="submit-button" disabled="true"  hidden="true">
                <label id="submit-button-label" for="submit-button" disabled="true"   class="btn btn-secondary">
                    <i class="material-icons">check</i>
                    <span id="confirm-button-label">Отправить</span>
                </label>
            </div>
        </li>
    </form>
    <!--    <li class="list-group-item" style="align-items: center; justify-content: center">-->
    <!--        <div style="width:100%; justify-content: center">-->
    <!--            <button id="submit-button" type="button" class="btn btn-primary" onclick="submit()"><i class="material-icons">check</i> Отправить</button>-->
    <!--            <div id="error-message"></div>-->
    <!--        </div>-->
    <!--    </li>-->
    <div>

    </div>
    <script>

        let excelUploaded = false;
        let pdfUploaded = false;
        let isAgreeChecked = false;
        let isProtectedChecked = false;

        const buttonSubmit = document.getElementById('submit-button')
        const buttonSubmitLabel = document.getElementById('submit-button-label')
        function checkFields() {

            console.log(excelUploaded)
            console.log(pdfUploaded)
            console.log(isProtectedChecked)
            console.log(isAgreeChecked)
            const isDisabled = !(excelUploaded & pdfUploaded & isAgreeChecked & isProtectedChecked)
            console.log(buttonSubmitLabel)

            if(isDisabled) {
                console.log(buttonSubmitLabel.classList)
                buttonSubmitLabel.classList.remove('btn-primary')
                buttonSubmitLabel.classList.add('btn-secondary')
            } else {
                console.log(buttonSubmitLabel.classList)
                buttonSubmitLabel.classList.add('btn-primary')
                buttonSubmitLabel.classList.remove('btn-secondary')
            }



            buttonSubmit.disabled = isDisabled
            buttonSubmitLabel.disabled = isDisabled
            console.log(buttonSubmit.disabled)
            console.log(buttonSubmitLabel.disabled)

        }

        function getName (str, component){
            let i = 0;
            if (str.lastIndexOf('\\')){
                i = str.lastIndexOf('\\')+1;
            }
            else{
                i = str.lastIndexOf('/')+1;
            }
            let filename = str.slice(i);
            let uploaded = document.getElementById(component);
            uploaded.innerHTML = filename;

            if(component === 'excel-button-label'){
                excelUploaded = true
            }

            if(component === 'pdf-button-label'){
                pdfUploaded = true
            }



        }

        function changeComboBox(component) {
            if(component.id === 'agreed-checkbox'){
                isAgreeChecked = component.checked;
            }

            if(component.id === 'protect-checkbox'){
                isProtectedChecked = component.checked;
            }
        }

        function submit (){
            const isProtected = document.getElementById('protect-checkbox');
            const isAgreed = document.getElementById('agreed-checkbox');



            return false
        }
    </script>
</div>

</body>
</html>

